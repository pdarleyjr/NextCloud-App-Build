{"version":3,"file":"form.js","mappings":"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","sources":["webpack://appointments/./src/form.js"],"sourcesContent":["(function () {\n\t\"use strict\"\n\twindow.addEventListener('DOMContentLoaded', formReady)\n\n\tfunction formReady() {\n\t\tlet gdpr = document.getElementById('appt_gdpr_id')\n\t\tif (gdpr !== null) {\n\t\t\tgdpr.addEventListener('change', gdprCheck)\n\t\t\tgdprCheck.apply(gdpr)\n\t\t}\n\n\t\tlet f = document.getElementById(\"srgdev-ncfp_frm\")\n\t\tf.addEventListener(\"submit\", formSubmit)\n\n\t\t// chrome bfcache\n\t\tsetTimeout(function () {\n\t\t\tf.autocomplete = \"on\"\n\t\t}, 1000)\n\n\t\tconst pso = makePso(f.getAttribute(\"data-pps\"))\n\t\tprefillFields(pso)\n\t\tmakeDpu(pso)\n\t\tdocument.getElementById(\"srgdev-ncfp_sel-dummy\").addEventListener(\"click\", selClick)\n\t\tdocument.getElementById(\"srgdev-ncfp_sel-dummy\").addEventListener(\"keyup\", function (evt) {\n\t\t\tif (isSpaceKey(evt)) {\n\t\t\t\tselClick(evt)\n\t\t\t}\n\t\t})\n\n\t\tsetTimeout(function () {\n\t\t\tlet b = document.getElementById(\"srgdev-ncfp_fbtn\")\n\t\t\tlet txt\n\t\t\t// translations are done on the backend (bug???)\n\t\t\tif (b.hasAttribute(\"data-tr-ses-to\")) {\n\t\t\t\ttxt = b.getAttribute('data-tr-ses-to')\n\t\t\t} else {\n\t\t\t\t// Back-up ????\n\t\t\t\ttxt = 'Session Timeout. Reload.';\n\t\t\t}\n\t\t\tb.disabled = true;\n\t\t\tb.textContent = txt\n\t\t}, 900000)\n\t}\n\n\tfunction makePso(pps) {\n\t\tlet pso = {}\n\t\tlet ta = pps.split('.')\n\t\tfor (let a, l = ta.length, i = 0; i < l; i++) {\n\t\t\ta = ta[i].split(':')\n\t\t\tpso[a[0]] = +a[1]\n\t\t}\n\t\treturn pso\n\t}\n\n\n\tfunction prefillFields(pso) {\n\n\t\tconst formInputs = document.getElementById('srgdev-ncfp-main-inputs')\n\n\t\tconst urlParams = new URLSearchParams(\n\t\t\t(pso['prefillInputs'] & 1) > 0\n\t\t\t\t? window.location.search : ''\n\t\t);\n\n\t\tif (urlParams) {\n\t\t\t// iterate over every formInputs and check if there is a query parameter with the same name\n\t\t\tconst prefilledType = pso['prefilledType']\n\t\t\tfor (let elm of formInputs.children) {\n\t\t\t\tif (urlParams.has(elm.name)) {\n\t\t\t\t\t// set the input's value\n\t\t\t\t\telm.value = urlParams.get(elm.name)\n\n\t\t\t\t\tif (prefilledType === 2) {\n\t\t\t\t\t\t// hide inputs\n\t\t\t\t\t\telm.style.display = 'none'\n\t\t\t\t\t\tconst label = document.querySelector(`label[for=\"${elm.id}\"]`)\n\t\t\t\t\t\tif (label) {\n\t\t\t\t\t\t\tlabel.style.display = 'none'\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (prefilledType === 1) {\n\t\t\t\t\t\t// readonly / plain text\n\t\t\t\t\t\telm.disabled = true\n\n\t\t\t\t\t\t// create a label containing the input value\n\t\t\t\t\t\tconst valueLabel = document.createElement('label')\n\t\t\t\t\t\tvalueLabel.textContent = elm.value\n\t\t\t\t\t\tvalueLabel.style.display = 'block'\n\t\t\t\t\t\tvalueLabel.style.fontWeight = 'bold'\n\n\t\t\t\t\t\t// append the label after the input\n\t\t\t\t\t\tformInputs.insertBefore(valueLabel, elm.nextSibling)\n\n\t\t\t\t\t\t// hide the field\n\t\t\t\t\t\telm.style.display = 'none'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction gdprCheck() {\n\t\tlet btn = document.getElementById(\"srgdev-ncfp_fbtn\")\n\t\tif (this.checked) {\n\t\t\tif (btn.hasAttribute('shade')) btn.removeAttribute('shade')\n\t\t} else {\n\t\t\tif (!btn.hasAttribute('shade')) btn.setAttribute('shade', \"1\")\n\t\t}\n\n\t\tif (this.hasAttribute(\"err\")) {\n\t\t\tthis.removeAttribute(\"err\")\n\t\t}\n\t\tif (this.hasAttribute(\"required\")) {\n\t\t\tthis.removeAttribute(\"required\")\n\t\t}\n\n\t}\n\n\tfunction clearFormErr() {\n\t\tthis.setCustomValidity('')\n\t\tif (this.getAttribute('err')) {\n\t\t\tthis.removeAttribute('err')\n\t\t\tthis.removeEventListener(\"focus\", clearFormErr, false)\n\t\t} else {\n\t\t\tthis.removeEventListener(\"input\", clearFormErr, false)\n\t\t}\n\t}\n\n\tfunction formSubmit(e) {\n\t\tlet lee = 0\n\n\t\tconst translations = {}\n\t\tconst trStr = document.getElementById(\"srgdev-ncfp_frm\").getAttribute(\"data-translations\")\n\t\t// trStr looks something like this \"key1:translation1,key2:transaltion2,...\"\n\t\ttrStr.split(',').forEach(ps => {\n\t\t\tconst pair = ps.split(\":\")\n\t\t\ttranslations[pair[0]] = pair[1]\n\t\t})\n\n\t\tlet el = document.getElementById(\"srgdev-ncfp_fbtn\")\n\t\tif (el.disabled === true) {\n\t\t\te.preventDefault()\n\t\t\te.stopPropagation()\n\t\t\treturn false\n\t\t}\n\n\t\tel = document.getElementById(\"srgdev-ncfp_sel-hidden\")\n\t\tlet sdx = el.selectedIndex\n\t\tlet tzi\n\t\tif (sdx === -1 || el.value === \"\") {\n\t\t\tel = document.getElementById(\"srgdev-ncfp_sel-dummy\")\n\t\t\tel.setAttribute('err', 'err');\n\t\t\tel.addEventListener(\"focus\", clearFormErr, false)\n\t\t\tlee = 1\n\t\t} else {\n\t\t\ttzi = el.dataRef[sdx].tzi\n\t\t}\n\n\t\tel = document.getElementById(\"srgdev-ncfp_talk_type\")\n\t\tif (el !== null) {\n\t\t\tsdx = el.selectedIndex\n\t\t\tif (sdx !== 1 && sdx !== 2) {\n\t\t\t\tel.setAttribute('err', 'err');\n\t\t\t\tel.addEventListener(\"focus\", clearFormErr, false)\n\t\t\t\tlee = 1\n\t\t\t}\n\t\t}\n\n\t\tel = document.getElementById(\"srgdev-ncfp_fname\")\n\t\tif (el.value.length < 2) {\n\t\t\tel.setCustomValidity(translations['name_required']);\n\t\t\tel.addEventListener(\"input\", clearFormErr, false)\n\t\t\tif (lee === 0) el.reportValidity()\n\t\t\tlee = 1\n\t\t}\n\t\tel = document.getElementById(\"srgdev-ncfp_femail\")\n\t\tif (el.value.length < 5 || el.value.indexOf(\"@\") === -1 || el.value.indexOf(\"@\") > el.value.lastIndexOf(\".\")) {\n\t\t\tel.setCustomValidity(translations['email_required']);\n\t\t\tel.addEventListener(\"input\", clearFormErr, false)\n\t\t\tif (lee === 0) el.reportValidity()\n\t\t\tlee = 1\n\t\t}\n\t\t// Phone field is optional\n\t\t// match [0-9], '.()-+,/' and ' ' (space) at least 9 digits\n\t\tel = document.getElementById(\"srgdev-ncfp_fphone\")\n\t\tif (el !== null && (el.value === '' || el.value.length < 9 || /^[0-9 .()\\-+,/]*$/.test(el.value) === false)) {\n\t\t\tel.setCustomValidity(translations['phone_required']);\n\t\t\tel.addEventListener(\"input\", clearFormErr, false)\n\t\t\tif (lee === 0) el.reportValidity()\n\t\t\tlee = 1\n\t\t}\n\n\t\t//Check for custom inputs\n\t\tlet elms = document.getElementById('srgdev-ncfp-main-inputs').children\n\t\tfor (let i = 0, elm, l = elms.length; i < l; i++) {\n\t\t\telm = elms[i]\n\t\t\tif (elm.hasAttribute('data-more')) {\n\t\t\t\tif (elm.tagName === 'INPUT' || elm.tagName === 'TEXTAREA') {\n\t\t\t\t\tlet cv = elm.value.trim()\n\t\t\t\t\tif (elm.getAttribute('data-more') === 'r1' && cv === '') {\n\t\t\t\t\t\telm.setCustomValidity(translations['required']);\n\t\t\t\t\t\telm.addEventListener(\"input\", clearFormErr, false)\n\t\t\t\t\t\tif (lee === 0) elm.reportValidity()\n\t\t\t\t\t\tlee = 1\n\t\t\t\t\t} else if (elm.hasAttribute('type') && elm.getAttribute('type') === 'number' && isNaN(cv)) {\n\t\t\t\t\t\telm.setCustomValidity(translations['number_required']);\n\t\t\t\t\t\telm.addEventListener(\"input\", clearFormErr, false)\n\t\t\t\t\t\tif (lee === 0) elm.reportValidity()\n\t\t\t\t\t\tlee = 1\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tel = document.getElementById('appt_gdpr_id')\n\t\tif (el !== null && el.checked === false) {\n\t\t\tel.setAttribute(\"err\", \"err\")\n\t\t\tel.setAttribute(\"required\", \"1\")\n\t\t\tlee = 1\n\t\t}\n\n\t\tif (lee !== 0) {\n\t\t\te.preventDefault()\n\t\t\te.stopPropagation()\n\t\t\treturn false\n\t\t}\n\t\tdocument.getElementById(\"srgdev-ncfp_fbtn-spinner\").style.display = \"inline-block\"\n\t\tel = document.createElement(\"input\")\n\t\tel.type = \"hidden\"\n\t\tel.name = \"tzi\"\n\t\tel.value = tzi\n\t\tthis.appendChild(el)\n\t}\n\n\tfunction selClose(elm) {\n\t\tdocument.body.removeEventListener(\"keyup\", selEscCloseListener)\n\t\tdocument.getElementById(\"srgdev-ncfp_frm\").removeEventListener(\"focusin\", focusTrapListener)\n\t\tif (elm === null) {\n\t\t\telm = document.getElementById(\"srgdev-dpu_main-cont\")\n\t\t}\n\t\telm.removeAttribute(\"data-open\")\n\t}\n\n\tfunction selEscCloseListener(evt) {\n\t\tif (evt.key === \"Escape\" || evt.key === \"Esc\" || evt.keyCode === 27) {\n\t\t\tselClose(null)\n\t\t\te.preventDefault()\n\t\t}\n\t}\n\n\tfunction focusTrapListener(evt) {\n\t\tif (evt.target\n\t\t\t&& (evt.target.nodeName.toUpperCase() !== \"DIV\"\n\t\t\t\t&& evt.target.nodeName.toUpperCase() !== \"SPAN\"\n\t\t\t\t&& evt.target.id !== 'srgdev-dpu_tz-picker'\n\t\t\t)) {\n\t\t\t// (Re)set focus to first available\n\t\t\tdocument.getElementById(\"srgdev-dpu_main-date\").firstAvailble.focus()\n\t\t}\n\t}\n\n\n\tfunction selClick(e) {\n\t\tlet elm = document.getElementById(\"srgdev-dpu_main-cont\")\n\t\tif (elm.getAttribute(\"data-open\") === null) {\n\t\t\telm.setAttribute(\"data-open\", '')\n\t\t\tdocument.body.addEventListener(\"keyup\", selEscCloseListener)\n\t\t\tconst curActive = document.getElementById(\"srgdev-dpu_main-date\").curActive\n\t\t\tif (curActive && curActive.indexOf('e') === -1) {\n\t\t\t\tdocument.getElementById(\"srgdev-dpu_dc\" + curActive).focus()\n\t\t\t}\n\n\t\t\t// trap focus inside popup\n\t\t\tdocument.getElementById(\"srgdev-ncfp_frm\").addEventListener(\"focusin\", focusTrapListener)\n\n\t\t} else {\n\t\t\tselClose(elm)\n\t\t}\n\t\te.preventDefault()\n\t\treturn false\n\t}\n\n\tfunction dateKeyboard(evt) {\n\t\tif (isSpaceKey(evt) || isEnterKey(evt)) {\n\t\t\t// select first available time\n\t\t\tconst timeCont = document.getElementById('srgdev-dpu_tc_wrap')\n\t\t\tif (timeCont) {\n\t\t\t\ttimeCont.firstChild.focus()\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction dateClickOrFocus(e) {\n\n\t\tlet n = this.id.slice(13)\n\t\tlet c = this.parentElement.curActive\n\t\tif (c === n) return\n\t\t// special case: initial programmatic click event\n\t\tif (!c) {\n\t\t\tc = n\n\t\t}\n\n\t\tconst nbr = +(('' + n).replace(\"e\", ''))\n\t\t// scroll dateCont into view when using keyboard\n\t\tconst bfCont = document.getElementById(\"srgdev-dpu_bf-cont\")\n\t\tconst wantedDP = Math.floor(nbr / 5)\n\t\tif (wantedDP !== bfCont.curDP) {\n\t\t\tbfCont.curDP = wantedDP\n\t\t\tprevNextDPU(bfCont)\n\t\t}\n\n\t\tdocument.getElementById('srgdev-dpu_dc' + c)\n\t\t\t.removeAttribute('data-active');\n\t\tdocument.getElementById('srgdev-dpu_dc' + n).setAttribute('data-active', '')\n\t\tthis.parentElement.curActive = n\n\n\t\tif (n.slice(-1) === 'e') n = 'e'\n\t\t// if (c.slice(-1) === 'e') c = 'e'\n\n\t\tconst timeCont = document.getElementById(\"srgdev-dpu_main-time\")\n\t\tif (!timeCont) {\n\t\t\tthrow new Error(\"srgdev-dpu_main-time missing\")\n\t\t}\n\t\twhile (timeCont.firstChild) {\n\t\t\ttimeCont.removeChild(timeCont.lastChild);\n\t\t}\n\t\tif (n !== 'e') {\n\n\t\t\tconst timePage = timeCont.timePages[n]\n\n\t\t\tlet elm = document.createElement('div')\n\t\t\telm.className = \"srgdev-dpu-tc-full-date\"\n\t\t\telm.appendChild(document.createTextNode(timePage.fullDate))\n\n\t\t\ttimeCont.appendChild(elm)\n\n\t\t\tconst tuClass = bfCont.tuClass\n\n\t\t\tconst itemsCont = document.createElement('div')\n\t\t\titemsCont.className = 'srgdev-dpu-tc-tu-wrap'\n\t\t\titemsCont.id = \"srgdev-dpu_tc_wrap\"\n\t\t\titemsCont.setAttribute('data-dm', timePage.dataDm)\n\n\t\t\ttimePage.timeItems.forEach(item => {\n\n\t\t\t\tconst elm = document.createElement(\"span\")\n\t\t\t\telm.className = tuClass\n\t\t\t\telm.dpuClickID = item.dpuClickID\n\t\t\t\telm.timeAt = item.timeAt\n\t\t\t\telm.appendChild(document.createTextNode(item.time))\n\t\t\t\tif (item.title !== \"\") {\n\t\t\t\t\tconst elm1 = document.createElement(\"span\")\n\t\t\t\t\telm1.className = \"srgdev-dpu-appt-title\"\n\t\t\t\t\telm1.appendChild(document.createTextNode(item.title))\n\t\t\t\t\telm.appendChild(elm1)\n\t\t\t\t}\n\t\t\t\telm.setAttribute(\"tabindex\", \"0\")\n\t\t\t\titemsCont.appendChild(elm)\n\t\t\t})\n\n\t\t\ttimeCont.appendChild(itemsCont)\n\t\t} else {\n\t\t\t// empty time cont\n\t\t\tconst elm = document.createElement('div')\n\t\t\telm.id = \"srgdev-dpu_tce\"\n\t\t\telm.className = 'srgdev-dpu-time-cont'\n\t\t\telm.appendChild(document.createTextNode(document.getElementById('srgdev-ncfp_sel-hidden').getAttribute(\"data-tr-not-available\")))\n\t\t\ttimeCont.appendChild(elm)\n\t\t}\n\n\t\tthis.parentElement.parentElement.scrollLeft = 0\n\n\t\te.stopPropagation()\n\t}\n\n\n\tfunction timeClick(e) {\n\t\tlet t = e.target\n\n\t\tif (t.parentElement.dpuClickID !== undefined) {\n\t\t\tt = t.parentElement;\n\t\t}\n\n\t\tif (t.dpuClickID !== undefined) {\n\t\t\tdocument.getElementById('srgdev-ncfp_sel-dummy').value = t.parentElement.getAttribute('data-dm') + ' - ' + t.timeAt;\n\t\t\tlet elm = document.getElementById('srgdev-ncfp_sel-hidden')\n\t\t\telm.selectedIndex = t.dpuClickID\n\t\t\telm.value = elm.dataRef[t.dpuClickID].d\n\n\t\t\tconst dur = elm.dataRef[t.dpuClickID].dur\n\t\t\telm = document.getElementById('srgdev-ncfp_dur-cont')\n\n\t\t\tconst hrStr = elm.getAttribute(\"data-tr-hr\")\n\t\t\tconst mnStr = elm.getAttribute(\"data-tr-mn\")\n\t\t\tconst makeHrMin = function (v) {\n\t\t\t\tlet hrMinStr = \"\"\n\t\t\t\tconst hours = (v / 60) | 0\n\t\t\t\tif (hours > 0) {\n\t\t\t\t\thrMinStr += hours + hrStr + \" \"\n\t\t\t\t}\n\t\t\t\tconst minutes = (v - hours * 60)\n\t\t\t\treturn hrMinStr + (minutes > 0 ? (minutes + mnStr) : '')\n\t\t\t}\n\t\t\tif (dur === null || dur.length === 1) {\n\t\t\t\telm.style.display = 'none'\n\t\t\t} else {\n\t\t\t\tconst opts = elm.lastElementChild.children\n\t\t\t\topts[0].textContent = makeHrMin(dur[0])\n\t\t\t\tfor (let o, i = 1, hours = 0, minutes = 0, l = Math.max(opts.length, dur.length); i < l; i++) {\n\t\t\t\t\tif (i >= opts.length) {\n\t\t\t\t\t\t// create\n\t\t\t\t\t\to = document.createElement('option')\n\t\t\t\t\t\to.className = 'srgdev-ncfp-form-option'\n\t\t\t\t\t\to.appendChild(document.createTextNode(''))\n\t\t\t\t\t\telm.lastElementChild.appendChild(o)\n\t\t\t\t\t} else {\n\t\t\t\t\t\to = opts[i]\n\t\t\t\t\t\tif (i >= dur.length) {\n\t\t\t\t\t\t\to.style.display = 'none'\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\to.style.display = 'block'\n\t\t\t\t\to.value = i\n\t\t\t\t\to.textContent = makeHrMin(dur[i])\n\t\t\t\t}\n\t\t\t\telm.style.display = 'block'\n\t\t\t}\n\t\t\telm.lastElementChild.value = 0\n\n\t\t\tselClose(null)\n\t\t}\n\t}\n\n\tfunction prevNextDPU(e) {\n\t\tlet p\n\t\t// e.target===undefined when we do initial \"scroll\" @see makeDpu()\n\t\tif (e.target !== undefined) {\n\t\t\tp = e.target.parentElement\n\t\t\tif (e.target.id === \"srgdev-dpu_bf-back\") {\n\t\t\t\tif (p.curDP > 0) p.curDP--\n\t\t\t} else {\n\t\t\t\tif (p.curDP < p.maxDP) p.curDP++\n\t\t\t\tif (p.curDP === p.maxDP) {\n\t\t\t\t\te.target.setAttribute('disabled', '')\n\t\t\t\t} else {\n\t\t\t\t\te.target.removeAttribute('disabled')\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tp = e;\n\t\t}\n\t\tif (p.curDP === 0) {\n\t\t\tp.firstElementChild.setAttribute('disabled', '')\n\t\t} else {\n\t\t\tp.firstElementChild.removeAttribute('disabled')\n\t\t}\n\n\t\tif (p.curDP === p.maxDP) {\n\t\t\tp.lastElementChild.setAttribute('disabled', '')\n\t\t} else {\n\t\t\tp.lastElementChild.removeAttribute('disabled')\n\t\t}\n\n\t\t// TODO: find first not empty and select it ?\n\n\t\tdocument.getElementById(\"srgdev-dpu_main-date\").style.left = \"-\" + (p.curDP * 5 * 4.6) + \"em\"\n\n\t\tdocument.getElementById(\"srgdev-dpu_main-cont\").scrollLeft = 0\n\t}\n\n\tfunction addSwipe(cont, bfc) {\n\t\tcont.touchInfo = {x: 0, y: 0, id: -1}\n\t\tcont.bfNav = bfc\n\t\tcont.addEventListener(\"touchstart\", swipeStart)\n\t\tcont.addEventListener(\"touchend\", swipeEnd)\n\n\t}\n\n\t/** @param {TouchEvent} e */\n\tfunction swipeStart(e) {\n\t\tif (e.changedTouches !== undefined && e.changedTouches.length > 0) {\n\t\t\tconst cc = e.changedTouches[0]\n\t\t\tconst ti = this.touchInfo\n\t\t\tti.x = cc.clientX\n\t\t\tti.y = cc.clientY\n\t\t\tti.id = cc.identifier\n\t\t}\n\t}\n\n\t/** @param {TouchEvent} e */\n\tfunction swipeEnd(e) {\n\t\tif (e.changedTouches !== undefined && e.changedTouches.length > 0) {\n\t\t\tconst cc = e.changedTouches[0]\n\t\t\tconst ti = this.touchInfo\n\t\t\tif (cc.identifier === ti.id) {\n\t\t\t\tconst dx = (cc.clientX - ti.x) | 0\n\t\t\t\tconst dy = (cc.clientY - ti.y) | 0\n\t\t\t\tlet t = dx >> 31\n\t\t\t\tlet dx_abc = ((dx + t) ^ t)\n\t\t\t\tt = dy >> 31\n\t\t\t\tif (dx_abc > ((dy + t) ^ t) && dx_abc > 50) {\n\t\t\t\t\tif (dx < 0) {\n\t\t\t\t\t\t// swipe left - push next\n\t\t\t\t\t\tthis.bfNav.lastElementChild.click()\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// swipe right - push prev\n\t\t\t\t\t\tthis.bfNav.firstElementChild.click()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tti.id = -1\n\t\t}\n\t}\n\n\t/**\n\t * @return {Promise<string[]>}\n\t */\n\tasync function getIanaTimeZones() {\n\n\t\ttry {\n\t\t\tconst zones = Intl.supportedValuesOf('timeZone').filter(zone => zone.indexOf('/') !== -1 && !zone.startsWith('Etc'));\n\t\t\treturn Promise.resolve(zones)\n\t\t} catch (e) {\n\t\t\tconsole.error('Intl.supportedValuesOf failed/not available', e)\n\t\t}\n\n\t\t// support for Intl.supportedValuesOf is not so good I guess\n\t\tlet zonesFile = document.getElementById('srgdev-ncfp_frm').getAttribute('data-zones')\n\t\tif (zonesFile) {\n\t\t\treturn fetch(zonesFile)\n\t\t\t\t.then(res => {\n\t\t\t\t\treturn res.json()\n\t\t\t\t})\n\t\t\t\t.then(json => {\n\n\t\t\t\t\tif (!json.zones || !(typeof json.zones === 'object' && !Array.isArray(json.zones))\n\t\t\t\t\t) {\n\t\t\t\t\t\tthrow new Error(\"invalid zones data\")\n\t\t\t\t\t}\n\t\t\t\t\tconst zones = Object.keys(json.zones)\n\t\t\t\t\tif (zones.length === 0) {\n\t\t\t\t\t\tthrow new Error(\"empty zones data\")\n\t\t\t\t\t}\n\t\t\t\t\treturn zones;\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.error('fetch(zonesFile) failed:', e)\n\t\t\t\t\treturn ['error: no_timezones_info']\n\t\t\t\t})\n\t\t}\n\t}\n\n\tfunction getTzName(lang, iana) {\n\t\tconst d = new Date()\n\t\tconst short = d.toLocaleDateString(lang, {timeZone: iana});\n\t\tconst full = d.toLocaleDateString(lang, {timeZone: iana, timeZoneName: 'long'});\n\n\t\t// Trying to remove date from the string in a locale-agnostic way\n\t\tconst shortIndex = full.indexOf(short);\n\t\tif (shortIndex >= 0) {\n\t\t\tconst trimmed = full.substring(0, shortIndex) + full.substring(shortIndex + short.length);\n\n\t\t\t// by this time `trimmed` should be the timezone's name with some punctuation -\n\t\t\t// trim it from both sides\n\t\t\treturn trimmed.replace(/^[\\s,.\\-:;]+|[\\s,.\\-:;]+$/g, '');\n\n\t\t} else {\n\t\t\treturn iana;\n\t\t}\n\t}\n\n\tfunction makeTzPicker(pso, lang, currentTz) {\n\n\t\tconst sel = document.createElement('select')\n\t\tsel.id = 'srgdev-dpu_tz-picker'\n\n\t\tsel.addEventListener('change', () => {\n\n\t\t\tif (sel.value === sel.currentTz) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsel.currentTz = sel.value\n\t\t\tlet selectedTz = undefined\n\t\t\ttry {\n\t\t\t\tselectedTz = Intl.DateTimeFormat(lang, {timeZone: sel.value}).resolvedOptions().timeZone\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\"tz selector: can not parse\", sel.value, e)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tsel.nextSibling.textContent = getTzName(lang, selectedTz)\n\t\t\tmakeDpu(pso, selectedTz)\n\t\t})\n\n\t\tif (!currentTz) {\n\t\t\tcurrentTz = Intl.DateTimeFormat(lang).resolvedOptions().timeZone\n\t\t}\n\t\t// stops un-needed reloads\n\t\tsel.currentTz = currentTz\n\n\t\tconst focusListener = async () => {\n\t\t\tconst ianaTzList = await getIanaTimeZones()\n\t\t\tianaTzList.forEach(tz => {\n\t\t\t\tconst opt = document.createElement('option')\n\t\t\t\topt.textContent = tz\n\t\t\t\tsel.appendChild(opt)\n\t\t\t})\n\t\t\tsel.value = currentTz\n\t\t\tsel.removeEventListener('focus', focusListener)\n\t\t}\n\t\tsel.addEventListener('focus', focusListener)\n\n\t\tconst title = document.createElement('div')\n\t\ttitle.className = 'srgdev-dpu-tz-name'\n\t\ttitle.innerText = getTzName(lang, currentTz)\n\n\t\tconst label = document.createElement('label')\n\t\tlabel.className = 'srgdev-dpu-tz-picker-wrapper'\n\t\tlabel.appendChild(sel)\n\t\tlabel.appendChild(title)\n\n\t\treturn label\n\t}\n\n\tconst PPS_NWEEKS = \"nbrWeeks\";\n\tconst PPS_EMPTY = \"showEmpty\";\n\tconst PPS_FNED = \"startFNED\";\n\tconst PPS_WEEKEND = \"showWeekends\";\n\tconst PPS_TIME2 = \"time2Cols\";\n\tconst PPS_END_TIME = \"endTime\";\n\n\tconst getFormatters = function (lang, btz, hasIntl) {\n\n\t\tconst mn = window.monthNames !== undefined\n\t\t\t? window.monthNames\n\t\t\t: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\t\tconst dn = window.dayNames !== undefined\n\t\t\t? window.dayNames\n\t\t\t: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n\n\t\treturn {\n\t\t\tdf: hasIntl\n\t\t\t\t? (new Intl.DateTimeFormat(lang,\n\t\t\t\t\t{month: \"long\", timeZone: btz})).format\n\t\t\t\t: function (d) {\n\t\t\t\t\treturn mn[d.getMonth()]\n\t\t\t\t},\n\t\t\twf: hasIntl\n\t\t\t\t? (new Intl.DateTimeFormat(lang,\n\t\t\t\t\t{weekday: \"short\", timeZone: btz})).format\n\t\t\t\t: function (d) {\n\t\t\t\t\treturn dn[d.getDay()]\n\t\t\t\t},\n\n\t\t\twft: hasIntl\n\t\t\t\t? new Intl.DateTimeFormat(lang,\n\t\t\t\t\t{weekday: \"short\", month: \"long\", day: \"2-digit\", timeZone: btz}).format\n\t\t\t\t: function (d) {\n\t\t\t\t\treturn d.toDateString()\n\t\t\t\t},\n\t\t\twff: hasIntl\n\t\t\t\t? new Intl.DateTimeFormat(lang,\n\t\t\t\t\t{weekday: \"long\", month: \"long\", day: \"numeric\", year: \"numeric\", timeZone: btz}).format\n\t\t\t\t: function (d) {\n\t\t\t\t\treturn d.toLocaleDateString()\n\t\t\t\t}\n\t\t}\n\t}\n\n\tconst makeDateCont = function (d, is_empty, min_days, ref, formatters) {\n\t\tlet e1 = document.createElement(\"div\")\n\t\te1.id = \"srgdev-dpu_dc\" + ref.lcc + (is_empty ? \"e\" : \"\")\n\t\te1.className = 'srgdev-dpu-date-cont' + (is_empty ? \" srgdev-dpu-dc-empty\" : \"\")\n\n\t\tlet e2 = document.createElement('span')\n\t\te2.className = d.getDay() !== 0 ? 'srgdev-dpu-date-wd' : 'srgdev-dpu-date-wd srgdev-dpu-date-wd-sunday';\n\t\te2.appendChild(document.createTextNode(formatters.wf(d)))\n\t\te1.appendChild(e2)\n\n\t\te2 = document.createElement('span')\n\t\te2.className = 'srgdev-dpu-date-dn'\n\t\te2.appendChild(document.createTextNode(d.getDate()))\n\t\te1.appendChild(e2)\n\n\t\te2 = document.createElement('span')\n\t\te2.className = 'srgdev-dpu-date-md'\n\t\te2.appendChild(document.createTextNode(formatters.df(d)))\n\t\te1.appendChild(e2)\n\n\t\te1.addEventListener('click', dateClickOrFocus)\n\t\tif (!is_empty) {\n\t\t\te1.setAttribute(\"tabindex\", \"0\")\n\t\t\te1.addEventListener('focus', dateClickOrFocus)\n\t\t\te1.addEventListener('keyup', dateKeyboard)\n\t\t}\n\n\t\tif (ref.lcc === ref.rccN) {\n\t\t\tref.rccN += 5\n\t\t\tref.bfMaxDP++\n\t\t\tif (ref.lcc > min_days) ref.do_break = true\n\t\t}\n\t\t++ref.lcc\n\t\treturn e1\n\t}\n\n\n\tfunction makeTimePages(lcTime, lcdBF, lcd, dta, pso, formatters) {\n\n\t\tconst min_days = 7 * pso[PPS_NWEEKS]\n\n\t\tconst ref = {\n\t\t\tlcc: 0,\n\t\t\trccN: 5,\n\t\t\tdo_break: false,\n\t\t\tbfMaxDP: 0\n\t\t}\n\n\t\tlet d = new Date()\n\t\tlet td = new Date()\n\t\ttd.setSeconds(1)\n\t\ttd.setMinutes(0)\n\t\ttd.setHours(0)\n\n\t\tif (pso[PPS_EMPTY] === 1 && pso[PPS_FNED] === 0) {\n\t\t\t// Need to prepend empty days so the week start on Monday\n\t\t\tlet ts = dta[0].rts\n\t\t\td.setTime(ts)\n\t\t\td.setSeconds(1)\n\t\t\td.setMinutes(0)\n\t\t\td.setHours(0)\n\t\t\tlet fd = d.getDay()\n\t\t\tif (fd > 0 && fd < 6) {\n\t\t\t\ttd.setTime(d.getTime() - 86400000 * (fd - 1))\n\t\t\t}\n\t\t}\n\n\t\tlet an = -1\n\t\tlet lastUD = -1\n\n\t\tconst timePages = []\n\t\tconst l = dta.length\n\t\tfor (let ts, ti, ets, tts, te, dto, timePage, i = 0; i < l; i++) {\n\t\t\tdto = dta[i]\n\t\t\tts = dto.rts\n\t\t\tif (ts === 0) break\n\t\t\td.setTime(ts)\n\n\t\t\tlet ud = ((d.getMonth() + 1) * 100) + d.getDate()\n\n\t\t\tif (lastUD !== ud) {\n\n\t\t\t\t// Show \"empty\" days ...\n\t\t\t\ttts = td.getTime()\n\t\t\t\ttd.setTime(d.getTime())\n\t\t\t\ttd.setSeconds(1)\n\t\t\t\ttd.setMinutes(0)\n\t\t\t\ttd.setHours(0)\n\t\t\t\tets = td.getTime()\n\n\t\t\t\tif (pso[PPS_EMPTY] === 1) {\n\t\t\t\t\twhile (tts < ets) {\n\t\t\t\t\t\ttd.setTime(tts)\n\n\t\t\t\t\t\t// Deal with weekends\n\t\t\t\t\t\tif (pso[PPS_WEEKEND] === 0) {\n\t\t\t\t\t\t\t// only show weekdays\n\t\t\t\t\t\t\tti = td.getDay()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// show all days\n\t\t\t\t\t\t\tti = 1\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (ti !== 0 && ti !== 6) {\n\t\t\t\t\t\t\tlcd.appendChild(makeDateCont(td, true, min_days, ref, formatters))\n\n\t\t\t\t\t\t\ttimePages.push({\n\t\t\t\t\t\t\t\tlccIdx: -1,\n\t\t\t\t\t\t\t\tdataDm: '',\n\t\t\t\t\t\t\t\ttimeItems: [],\n\t\t\t\t\t\t\t\tfullDate: '',\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tif (ref.do_break) break\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttts += 86400000;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (ref.do_break) {\n\t\t\t\t\td = td\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\ttd.setTime(tts + 86400000)\n\n\t\t\t\tte = makeDateCont(d, false, min_days, ref, formatters)\n\t\t\t\tif (an === -1) {\n\t\t\t\t\tan = ref.lcc - 1\n\t\t\t\t\tte.setAttribute('data-active', '')\n\t\t\t\t\tlcd.firstAvailble = te\n\t\t\t\t}\n\t\t\t\tlcd.appendChild(te)\n\n\t\t\t\t//\n\t\t\t\ttimePage = {\n\t\t\t\t\tlccIdx: ref.lcc - 1,\n\t\t\t\t\tdataDm: formatters.wft(d),\n\t\t\t\t\ttimeItems: [],\n\t\t\t\t\tfullDate: formatters.wff(d),\n\t\t\t\t}\n\t\t\t\ttimePages.push(timePage)\n\n\t\t\t\tlastUD = ud\n\t\t\t}\n\n\t\t\ttimePage.timeItems.push({\n\t\t\t\tdpuClickID: i,\n\t\t\t\ttimeAt: dto.timeAt,\n\t\t\t\ttime: dto.time,\n\t\t\t\ttitle: dto.t\n\t\t\t})\n\t\t}\n\n\t\t// fill in empty space ?????\n\t\t// d.setSeconds(0)\n\t\t// d.setMinutes(0)\n\t\t// d.setHours(1)\n\t\t// d.setTime(d.getTime() + 86400000)\n\n\t\tlcTime.timePages = timePages\n\t\tlcdBF.maxDP = ref.bfMaxDP\n\n\t\treturn an\n\t}\n\n\tfunction makeDpu(pso, selectedTz = undefined) {\n\n\t\tlet s = document.getElementById('srgdev-ncfp_sel-hidden')\n\t\tif (s.getAttribute(\"data-state\") !== '2') {\n\t\t\tconsole.log(\"data-state: \", s.getAttribute(\"data-state\"))\n\t\t\treturn\n\t\t}\n\t\t// There is a problem with js translations without Vue, so just get it from PHP for now\n\t\tconst dpuTrHdr = s.getAttribute(\"data-hdr\")\n\t\tconst dpuTrBack = s.getAttribute(\"data-tr-back\")\n\t\tconst dpuTrNext = s.getAttribute(\"data-tr-next\")\n\n\t\tconst has_intl = window.Intl && typeof window.Intl === \"object\"\n\t\tconst lang = document.documentElement.hasAttribute('data-locale')\n\t\t\t? [document.documentElement.getAttribute('data-locale').replaceAll('_', '-'), document.documentElement.lang]\n\t\t\t: [document.documentElement.lang]\n\n\t\tlet btz = undefined\n\t\tconst urlParams = new URLSearchParams(window.location.search);\n\n\t\tif (selectedTz !== undefined) {\n\t\t\tbtz = selectedTz\n\t\t} else if (urlParams) {\n\t\t\tconst tzParam = urlParams.get('tz');\n\t\t\tif (tzParam) {\n\t\t\t\ttry {\n\t\t\t\t\tbtz = Intl.DateTimeFormat(lang, {timeZone: tzParam}).resolvedOptions().timeZone\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"can not parse tz param:\", e)\n\t\t\t\t\tbtz = undefined\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet dta = []\n\t\tlet tzn = undefined\n\t\tif (has_intl) {\n\t\t\ttry {\n\t\t\t\ttzn = Intl.DateTimeFormat(lang, {timeZone: btz}).resolvedOptions().timeZone\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(\"no Intl timeZone \", e)\n\t\t\t}\n\t\t\tif (typeof tzn !== \"string\") tzn = undefined\n\t\t}\n\n\t\tconst tf = has_intl\n\t\t\t? (new Intl.DateTimeFormat(lang,\n\t\t\t\t{hour: \"numeric\", minute: \"2-digit\", timeZone: btz})).format\n\t\t\t: function (d) {\n\t\t\t\treturn d.toLocaleTimeString()\n\t\t\t}\n\n\t\tfor (let md = new Date(), tzo, tzi, t, tStr, atStr, sp, sp2, dur, dur_idx,\n\t\t\t     ts, endTime = pso[PPS_END_TIME],\n\t\t\t     ia = s.getAttribute(\"data-info\").split(','),\n\t\t\t     l = ia.length, i = 0, ds; i < l; i++) {\n\n\t\t\t//TODO: remove 'U' from ds ????\n\t\t\tds = ia[i]\n\n\t\t\tsp = ds.indexOf(\":\", 8);\n\t\t\tmd.setTime(+ds.substr(1, sp - 1) * 1000)\n\t\t\ttzo = md.getTimezoneOffset()\n\n\t\t\t// t='U' in simple and external modes\n\t\t\t// t='T' in template mode\n\t\t\tt = ds.charAt(0)\n\n\t\t\ttStr = atStr = tf(md)\n\n\t\t\tts = md.getTime()\n\n\t\t\tdur = null\n\t\t\tif (endTime === 1 || t === 'T') {\n\t\t\t\tsp2 = sp + 1\n\t\t\t\t// sp must be the pos of the last used ':'\n\t\t\t\tsp = ds.indexOf(\":\", sp2)\n\n\t\t\t\tif (t === \"T\") {\n\t\t\t\t\tdur = ds.substr(sp2, sp - sp2).split(';').map(n => n | 0)\n\t\t\t\t\tif (endTime === 1 && dur.length < 2) {\n\t\t\t\t\t\tmd.setTime(ts + dur[0] * 60000)\n\t\t\t\t\t\ttStr += ' - ' + tf(md)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsp2 = +ds.substr(sp2, sp - sp2) * 1000\n\t\t\t\t\tmd.setTime(sp2)\n\t\t\t\t\ttStr += ' - ' + tf(md)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (tzn !== undefined) {\n\t\t\t\ttzi = t + tzn\n\t\t\t} else {\n\t\t\t\t// fallback, needs to be done for every date because of daylight savings\n\t\t\t\tlet ao = Math.abs(tzo)\n\t\t\t\tlet h = Math.floor(ao / 60)\n\t\t\t\tlet m = ao - h * 60\n\t\t\t\t// offset sign is reversed https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset\n\t\t\t\ttzi = t + (tzo > 0 ? '-' : '+') + (h < 10 ? '0' + h : h) + (m < 10 ? '0' + m : m)\n\t\t\t}\n\n\t\t\tsp++\n\t\t\tsp2 = ds.indexOf(\":\", sp)\n\t\t\tdta[i] = {\n\t\t\t\trts: ts,\n\t\t\t\td: ds.substr(sp, sp2 - sp),\n\t\t\t\tt: ds.substr(sp2 + 2), // +2 is for \":_\"\n\t\t\t\tdur: dur,\n\t\t\t\ttzi: tzi,\n\t\t\t\ttime: tStr,\n\t\t\t\ttimeAt: atStr\n\t\t\t}\n\t\t}\n\n\t\tdta.sort((a, b) => (a.rts > b.rts) ? 1 : -1)\n\t\tdta.push({rts: 0, d: \"\", t: \"\", tzi: \"\", time: \"\"}) //last option to finalize the loop\n\n\t\t// console.log('makeDpu, dta:', dta)\n\t\ts.dataRef = dta\n\n\t\tconst bfElmId = 'srgdev-dpu_bf-cont'\n\t\tconst mainDateElmId = 'srgdev-dpu_main-date'\n\t\tconst mainTimeElmId = 'srgdev-dpu_main-time'\n\n\t\tlet lcdBF, lcTime\n\t\tlet lcd = document.getElementById(mainDateElmId)\n\t\tif (lcd !== null) {\n\t\t\t// time zone changed\n\t\t\twhile (lcd.firstChild) {\n\t\t\t\tlcd.removeChild(lcd.lastChild)\n\t\t\t}\n\t\t\tlcd.curActive = undefined\n\t\t\tlcTime = document.getElementById(mainTimeElmId)\n\t\t\tlcdBF = document.getElementById(bfElmId)\n\t\t} else {\n\t\t\t// first render\n\t\t\tconst cont = document.createElement('div')\n\t\t\tcont.id = \"srgdev-dpu_main-cont\"\n\t\t\tcont.className = \"srgdev-dpu-bkr-cls\"\n\n\t\t\tlcd = document.createElement('div')\n\t\t\tlcd.id = \"srgdev-dpu_main-header\"\n\t\t\tlcd.appendChild(document.createTextNode(dpuTrHdr))\n\t\t\tcont.appendChild(lcd)\n\n\t\t\tlcdBF = document.createElement('div')\n\t\t\tlcdBF.maxDP = 0\n\t\t\tlcdBF.curDP = 0\n\t\t\tlcdBF.tuClass = \"\"\n\t\t\tlcdBF.id = bfElmId\n\t\t\tlcdBF.appendChild(document.createElement(\"span\"))\n\t\t\tlcdBF.appendChild(document.createElement(\"span\"))\n\t\t\tlcdBF.firstElementChild.id = \"srgdev-dpu_bf-back\"\n\t\t\tlcdBF.firstElementChild.appendChild(document.createTextNode(dpuTrBack))\n\t\t\tlcdBF.firstElementChild.addEventListener(\"click\", prevNextDPU)\n\t\t\tlcdBF.firstElementChild.setAttribute('disabled', '')\n\t\t\tlcdBF.lastElementChild.id = \"srgdev-dpu_bf-next\"\n\t\t\tlcdBF.lastElementChild.appendChild(document.createTextNode(dpuTrNext))\n\t\t\tlcdBF.lastElementChild.addEventListener(\"click\", prevNextDPU)\n\t\t\t// Time columns\n\t\t\tif (pso[PPS_TIME2] === 0 || pso[PPS_END_TIME] === 1) {\n\t\t\t\tlcdBF.tuClass = 'srgdev-dpu-time-unit' +\n\t\t\t\t\t(pso[PPS_END_TIME] === 1 ? \"_tn\" : \"\")\n\t\t\t} else {\n\t\t\t\tlcdBF.tuClass = 'srgdev-dpu-time-unit2'\n\t\t\t}\n\t\t\tcont.appendChild(lcdBF)\n\n\t\t\tlcd = document.createElement('div')\n\t\t\tlcd.id = mainDateElmId\n\t\t\tlcd.className = \"srgdev-dpu-bkr-cls\"\n\t\t\tlcd.style.left = \"0em\"\n\t\t\taddSwipe(lcd, lcdBF)\n\t\t\tcont.appendChild(lcd)\n\n\t\t\tlcTime = document.createElement('div')\n\t\t\tlcTime.id = mainTimeElmId\n\t\t\tcont.appendChild(lcTime)\n\n\t\t\tif (has_intl) {\n\t\t\t\tcont.appendChild(makeTzPicker(pso, lang, btz))\n\t\t\t}\n\n\t\t\t// close button is added last because we want it last for keyboard focus\n\t\t\tconst btn = document.createElement('div')\n\t\t\tbtn.id = \"srgdev-dpu_main-hdr-icon\"\n\t\t\tbtn.className = \"icon-close\"\n\t\t\tbtn.addEventListener('click', function () {\n\t\t\t\tselClose(null)\n\t\t\t})\n\t\t\tbtn.role = \"button\"\n\t\t\tbtn.addEventListener('keyup', function (evt) {\n\t\t\t\tif (isSpaceKey(evt) || isEnterKey(evt)) {\n\t\t\t\t\tselClose(null)\n\t\t\t\t}\n\t\t\t})\n\t\t\tbtn.setAttribute(\"tabindex\", \"0\")\n\t\t\tcont.appendChild(btn)\n\n\t\t\tcont.addEventListener(\"click\", timeClick)\n\t\t\tcont.addEventListener('keyup', function (evt) {\n\t\t\t\tif (isSpaceKey(evt) || isEnterKey(evt)) {\n\t\t\t\t\ttimeClick(evt)\n\t\t\t\t}\n\t\t\t})\n\t\t\tdocument.getElementById('srgdev-ncfp_sel_cont').appendChild(cont)\n\t\t}\n\n\t\tconst an = makeTimePages(\n\t\t\tlcTime, lcdBF, lcd,\n\t\t\tdta, pso, getFormatters(lang, btz, has_intl)\n\t\t)\n\n\t\tlcd.firstAvailble.click()\n\t\tlcd.curActive = an.toString()\n\n\t\t// let's make sure the correct date square is shown...\n\t\t// ... 5 is the number of available slots per pagination page\n\t\tlet ti = Math.floor(an / 5)\n\t\tif (ti > 0) {\n\t\t\tlcdBF.curDP = ti\n\t\t\tprevNextDPU(lcdBF)\n\t\t}\n\t}\n\n\t/**\n\t * @param {KeyboardEvent} evt\n\t * @return {boolean}\n\t */\n\tfunction isSpaceKey(evt) {\n\t\treturn evt.key === \" \" || evt.code === \"Space\" || evt.keyCode === 32\n\t}\n\n\t/**\n\t * @param {KeyboardEvent} evt\n\t * @return {boolean}\n\t */\n\tfunction isEnterKey(evt) {\n\t\treturn evt.key === \"Enter\" || evt.code === \"Enter\" || evt.keyCode === 13\n\t}\n\n})()\n"],"names":["gdprCheck","btn","document","getElementById","this","checked","hasAttribute","removeAttribute","setAttribute","clearFormErr","setCustomValidity","getAttribute","removeEventListener","formSubmit","e","lee","translations","split","forEach","ps","pair","el","disabled","preventDefault","stopPropagation","tzi","sdx","selectedIndex","value","addEventListener","dataRef","length","reportValidity","indexOf","lastIndexOf","test","elms","children","elm","i","l","tagName","cv","trim","isNaN","style","display","createElement","type","name","appendChild","selClose","body","selEscCloseListener","focusTrapListener","evt","key","keyCode","target","nodeName","toUpperCase","id","firstAvailble","focus","selClick","curActive","dateKeyboard","isSpaceKey","isEnterKey","timeCont","firstChild","dateClickOrFocus","n","slice","c","parentElement","nbr","replace","bfCont","wantedDP","Math","floor","curDP","prevNextDPU","Error","removeChild","lastChild","timePage","timePages","className","createTextNode","fullDate","tuClass","itemsCont","dataDm","timeItems","item","dpuClickID","timeAt","time","title","elm1","scrollLeft","timeClick","t","undefined","d","dur","hrStr","mnStr","makeHrMin","v","hrMinStr","hours","minutes","opts","lastElementChild","textContent","o","max","p","maxDP","firstElementChild","left","swipeStart","changedTouches","cc","ti","touchInfo","x","clientX","y","clientY","identifier","swipeEnd","dx","dy","dx_abc","bfNav","click","getTzName","lang","iana","Date","short","toLocaleDateString","timeZone","full","timeZoneName","shortIndex","substring","makeTzPicker","pso","currentTz","sel","selectedTz","Intl","DateTimeFormat","resolvedOptions","nextSibling","makeDpu","focusListener","async","zones","supportedValuesOf","filter","zone","startsWith","Promise","resolve","zonesFile","fetch","then","res","json","Array","isArray","Object","keys","catch","getIanaTimeZones","tz","opt","innerText","label","window","gdpr","apply","f","setTimeout","autocomplete","pps","ta","a","makePso","formInputs","urlParams","URLSearchParams","location","search","prefilledType","has","get","querySelector","valueLabel","fontWeight","insertBefore","prefillFields","txt","b","PPS_NWEEKS","PPS_EMPTY","PPS_FNED","PPS_WEEKEND","PPS_TIME2","PPS_END_TIME","getFormatters","btz","hasIntl","mn","monthNames","dn","dayNames","df","month","format","getMonth","wf","weekday","getDay","wft","day","toDateString","wff","year","makeDateCont","is_empty","min_days","ref","formatters","e1","lcc","e2","getDate","rccN","bfMaxDP","do_break","arguments","s","dpuTrHdr","dpuTrBack","dpuTrNext","has_intl","documentElement","replaceAll","tzParam","tzn","dta","tf","hour","minute","toLocaleTimeString","tzo","tStr","atStr","sp","sp2","ts","ds","md","endTime","ia","setTime","substr","getTimezoneOffset","charAt","getTime","map","ao","abs","h","m","rts","sort","push","bfElmId","mainDateElmId","mainTimeElmId","lcdBF","lcTime","lcd","cont","bfc","addSwipe","role","an","td","setSeconds","setMinutes","setHours","fd","lastUD","ets","tts","te","dto","ud","lccIdx","makeTimePages","toString","code"],"sourceRoot":""}